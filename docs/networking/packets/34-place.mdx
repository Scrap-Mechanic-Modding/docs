---
title: 34 - Place - WIP
---

# Place

This packet is sent when the player places a shape.

- **ID**: 0x22 (34)
- **Size**: 109 bytes
- **LZ4 Compressed**: Yes
- **State**: Playing
- **Bound To**: Client -> Server

## Validation

### Uuids
The `Shape Uuid` is always validated to belong to a loaded shape. If this no shape exists with the provided `Shape Uuid`, the packet is ignored and the server responds with [19 - Display Alert Text](./19-display-alert-text.mdx) "Your host does not support that shape".

#### Limited inventory mode
The `Item Uuid` field must be valid for the given `Shape Uuid`. It is valid if the `Item Uuid` equals to the `Shape Uuid` or the `baseUuid` property in the shapeset JSON file. If it is invalid, the server ignores the packet.

#### Unlimited inventory mode
The `Item Uuid` field is ignored, the `Shape Uuid` is always used. Invalid uuids for the `Item Uuid` field are allowed.

## Structure

:::note
The `Local Position` and `Local Position Start` fields depend on the surface the shape is placed on. When local to the world, positions are relative to the world origin. Positions local to the body are in the same space as returned by `shape:getLocalPosition()`.

| Placed On       | Local positions |
|-----------------|-----------------|
| Terrain Surface | Local to world  |
| Terrain Asset   | Local to world  |
| Body            | Local to body   |
| Lift            | Local to world  |
| Joint           | Local to body   |
:::

| Offset | Field Name           | Field Type      | Notes |
|--------|----------------------|-----------------|-------|
| 0x00   | Hotbar Index         | be u32          | The index of the placed item in the hotbar. |
| 0x04   | Total Item Quantity  | be u32          | The total amount of items of the same type in the player's inventory. Always `1` when in unlimited inventory mode. |
| 0x08   | Size                 | [Vec3i](#vec3i) | The size of the blocks placed. Always `(0, 0, 0)` for parts, which the server ignores. |
| 0x14   | Local Position Start | [Vec3i](#vec3i) | The position, local to the world or body, where the shape is placed on. The placed shape will be connected to all sticky faces adjacent to this position. |
| 0x20   | Z Axis               | [Vec3i](#vec3i) | The Z-axis of the placed shape. |
| 0x2C   | X Axis               | [Vec3i](#vec3i) | The X-axis of the placed shape. |
| 0x38   | Local Position       | [Vec3i](#vec3i) | The position of the placed shape, local to the world or body. If local to the body (see note), this value matches the value returned by the `shape:getLocalPosition()` Lua API function. |
| 0x44   | Item Uuid            | le u128         | The UUID of the item in the inventory that is placed. This does not have to equal to the Shape Uuid. The Vacuum Pipes for example have multiple shapes that can be placed with a single item. |
| 0x54   | Shape Uuid           | le u128         | The UUID of the placed shape. |
| 0x64   | Placed On            | enum [PlacedOn](#placedon-enum) : u8 | The type of surface the shape is placed on. |
| 0x65   | Placed On Data       | ... (8 bytes)   | The data of the placed on surface. |

### Vec3i

:::note
The order of the coordinates is Z, Y, X, which may be seen as counterintuitive.
:::

| Offset | Field Name | Field Type | Notes |
|--------|------------|------------|-------|
| 0x00   | Z          | be s32     | The signed Z coordinate. |
| 0x04   | Y          | be s32     | The signed Y coordinate. |
| 0x08   | X          | be s32     | The signed X coordinate. |

### PlacedOn Enum

:::note
Not all PlacedOn enum values have been documented.
:::

| ID | Placed On |
|----|--------|
| 2  | [Terrain Surface](#placedon-2---terrain-surface) |
| 3  | [Terrain Asset](#placedon-3---terrain-asset) |
| 4  | [Body](#placedon-4---body) |
| 6  | [Lift](#placedon-6---lift) |
| 8  | [Joint](#placedon-8---joint) |

#### PlacedOn 2 - Terrain Surface

| Offset | Field Name | Field Type | Notes |
|--------|------------|------------|-------|
| 0x00   | Unknown    | 4 bytes    | Most of the time equal to `00 00 02 BB`, but right after entering the world equal to `D2 0A 69 8D`. The server accepts any value, modifying it does not seem to result in any changes. |
| 0x04   | Unknown    | 4 bytes    | Different every time. The server accepts any value, modifying it does not seem to result in any changes. |

#### PlacedOn 3 - Terrain Asset

Appears to be the same as [Terrain Surface](#placedon-2---terrain-surface).

#### PlacedOn 4 - Body

| Offset | Field Name | Field Type | Notes |
|--------|------------|------------|-------|
| 0x00   | Shape ID   | be u32     | The ID of the shape the new shape is placed on. Using a non-existing Shape ID is accepted by the server. |
| 0x04   | Body ID    | be u32     | The ID of the body the new shape is placed on. Using a non-existing Body ID will fail to create the shape. |

#### PlacedOn 6 - Lift

| Offset | Field Name | Field Type | Notes |
|--------|------------|------------|-------|
| 0x00   | Unknown    | 4 bytes    | Appears to be the same as the first Unknown field of [Terrain Surface](#placedon-2---terrain-surface). |
| 0x04   | Lift ID    | be u32     | The ID of the lift the new shape is placed on. Using a non-existing Lift ID results in the shape to become static. |

#### PlacedOn 8 - Joint

| Offset | Field Name | Field Type | Notes |
|--------|------------|------------|-------|
| 0x00   | Unknown    | 4 bytes    | Appears to be the same as the first Unknown field of [Terrain Surface](#placedon-2---terrain-surface). |
| 0x04   | Joint ID   | be u32     | The ID of the joint the new shape is placed on. Using a non-existing Joint ID will fail to create the shape. |
